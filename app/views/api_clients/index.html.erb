<% page_data(title: "API clients (#{govuk_number(@pagy.count)})") %>

<%= govuk_button_link_to("Add API Client", new_api_client_path) %>

<%= govuk_table do |table|
      table.with_head do |head|
        head.with_row do |row|
          row.with_cell(text: "Client name")
          row.with_cell(text: "Expires on")
          row.with_cell(text: "Status")
        end
      end
      table.with_body do |body|
        @records.each do |api_client|
          body.with_row do |row|
            row.with_cell(text: govuk_link_to(api_client.name, href: api_client_path(api_client)))
            row.with_cell(text: api_client.current_authentication_token.expires_at.to_fs(:govuk))
            row.with_cell(text: api_client.current_authentication_token.status.humanize, html_attributes: { class: "govuk-tag govuk-tag--#{api_client.current_authentication_token.status}" })
          end
        end
      end
    end %>

<%= render PaginationDisplay::View.new(pagy: @pagy) %>
